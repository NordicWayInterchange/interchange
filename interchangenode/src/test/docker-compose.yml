version: '3'
services:

  qpid:
    build: ../../../qpid
    container_name: qpid
    hostname: qpid
    healthcheck:
      test: ["CMD", "curl", "-I", "localhost:8080"]
      interval: 10s
      timeout: 5s
      retries: 5
    ports:
    - 8080:8080
    - 5671:5671
    - 5672:5672
    volumes:
    - "./resources/localhost.json:/config/default.json"
    - "./resources/jks2/localhost.p12:/secure/keystore.p12"
    - "./resources/jks2/truststore.jks:/secure/truststore.jks"
    environment:
      KEYSTORE_FILE: "/secure/keystore.p12"
      KEYSTORE_PASSWORD: "password"
      TRUSTSTORE_FILE: "/secure/truststore.jks"
      TRUSTSTORE_PASSWORD: "password"
      VHOST_FILE: "/config/default.json"
