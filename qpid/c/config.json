{
  "name": "${broker.name}",
  "modelVersion": "9.0",
  "authenticationproviders": [
    {
      "name": "clientCerts",
      "type": "External"
    },
    {
      "name": "passwordFile",
      "type": "PlainPasswordFile",
      "path": "/qpid-broker-j/work/passwd"
    }
  ],
  "brokerloggers" : [
    {
      "name" : "console",
      "type" : "Console",
      "lastUpdatedBy" : "admin",
      "brokerloginclusionrules" : [ {
        "name" : "rootInclude",
        "type" : "NameAndLevel",
        "durable" : true,
        "level" : "INFO"
      } ]
    }
  ],
  "keystores": [
    {
    "name" : "default",
    "type" : "FileKeyStore",
    "storeUrl" : "${KEY_STORE}",
    "password" : "${KEY_STORE_PASSWORD}"
    },
    {
      "name" : "internal-service",
      "type" : "FileKeyStore",
      "storeUrl" : "${INTERNAL_KEY_STORE}",
      "password" : "${INTERNAL_KEY_STORE_PASSWORD}"
    }
  ],
  "plugins": [
    {
      "type": "MANAGEMENT-HTTP",
      "name": "httpManagement"
    }
  ],
  "ports": [
    {
      "name": "INTERNAL_AMQPS",
      "type": "AMQP",
      "authenticationProvider": "clientCerts",
      "port": "5673",
      "bindingAddress": "*",
      "needClientAuth": true,
      "transports": [
        "SSL",
        "TCP"
      ],
      "trustStores": ["internal_truststore"],
      "keyStore": "internal-service",
      "wantClientAuth": false,
      "protocols": ["AMQP_1_0"],
      "virtualhostaliases": [
        {
          "name": "defaultAlias",
          "type": "defaultAlias"
        },
        {
          "name": "hostnameAlias",
          "type": "hostnameAlias"
        },
        {
          "name": "nameAlias",
          "type": "nameAlias"
        }
      ]
    },
    {
      "name": "AMQPS",
      "type": "AMQP",
      "authenticationProvider": "clientCerts",
      "bindingAddress": "*",
      "keyStore": "default",
      "needClientAuth": true,
      "port": "5671",
      "protocols": ["AMQP_1_0"],
      "transports": [
        "SSL",
        "TCP"
      ],
      "trustStores": ["default"],
      "wantClientAuth": false,
      "virtualhostaliases": [
        {
          "name": "defaultAlias",
          "type": "defaultAlias"
        },
        {
          "name": "hostnameAlias",
          "type": "hostnameAlias"
        },
        {
          "name": "nameAlias",
          "type": "nameAlias"
        }
      ]
    },
    {
      "name": "HTTP",
      "port": "8080",
      "authenticationProvider": "passwordFile",
      "protocols": ["HTTP"]
    },
    {
      "name": "HTTPS",
      "type" : "HTTP",
      "authenticationProvider" : "clientCerts",
      "bindingAddress" : "*",
      "port" : "443",
      "trustStores": ["internal_truststore"],
      "keyStore": "internal-service",
      "needClientAuth": true,
      "wantClientAuth": false,
      "transports": [
        "SSL",
        "TCP"
      ]
    }
  ],
  "truststores": [
    {
      "name": "default",
      "type": "FileTrustStore",
      "exposedAsMessageSource": false,
      "trustAnchorValidityEnforced": false,
      "storeUrl": "${TRUST_STORE}",
      "password": "${TRUST_STORE_PASSWORD}"
    },
    {
      "name": "internal_truststore",
      "type": "FileTrustStore",
      "exposedAsMessageSource": false,
      "trustAnchorValidityEnforced": false,
      "storeUrl": "${INTERNAL_TRUST_STORE}",
      "password": "${INTERNAL_TRUST_STORE_PASSWORD}"
    }
  ],
  "virtualhostnodes": [
    {
      "name": "default",
      "type": "JSON",
      "defaultVirtualHostNode": "true",
      "virtualHostInitialConfiguration": "{}"
    }
  ],
  "groupproviders" : [ {
    "name" : "default",
    "type" : "GroupFile",
    "path" : "/qpid-broker-j/work/groups"
  } ]
}
